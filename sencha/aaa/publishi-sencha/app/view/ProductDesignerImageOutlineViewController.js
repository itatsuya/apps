/*
 * File: app/view/ProductDesignerImageOutlineViewController.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.6.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.6.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('RolandKioskPrint.view.ProductDesignerImageOutlineViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.productdesignerimageoutline',

    setImageAdjustData: function(data) {
        // Set the data into the view model.
        this.getViewModel().setData(data)

    },

    disableRevertChanges: function(disable) {
        this.getView().down('#btnRevert').setDisabled(disable)

    },

    onRevertButtonClick: function(button, e, eOpts) {
        var imageOutlinePanel = this.getView().down('#imageOutlinePanel')

        imageOutlinePanel.getController().revertChanges()

    },

    onCancelButtonClick: function(button, e, eOpts) {
        var imageOutlinePanel = this.getView().down('#imageOutlinePanel')

        imageOutlinePanel.getController().performCleanup()


        RolandKioskPrint.app.destroyModalView(this.getView())

    },

    onOKButtonClick: function(button, e, eOpts) {
        var imageOutlinePanel = this.getView().down('#imageOutlinePanel')

        var imageAdjustData = imageOutlinePanel.getController().getImageAdjustData()

        imageAdjustData.clientView = true


        if (imageAdjustData.outlinePath) {
            // If image outline is extracted, confirm whether to keep the original image.
            Ext.Msg.confirm(
            RolandKioskPrint.app.getString('message.generic.confirmation'),
            RolandKioskPrint.app.getString('message.designer.keepImageConfirmation'),
            function(btnText) {
                imageAdjustData.keepImage = (btnText == 'yes')

                this.fireEvent('outlinePanelClosed', imageAdjustData)


                imageOutlinePanel.getController().performCleanup()

                RolandKioskPrint.app.destroyModalView(this.getView())

            }, this)

        } else {
            this.fireEvent('outlinePanelClosed', imageAdjustData)


            imageOutlinePanel.getController().performCleanup()

            RolandKioskPrint.app.destroyModalView(this.getView())

        }
    },

    onPanelBeforeShow: function(component, eOpts) {
        // Set the image adjust data on the child panel.
        var data = this.getViewModel().getData()

        var imageOutlinePanel = this.getView().down('#imageOutlinePanel')


        imageOutlinePanel.getController().setImageAdjustData({
            parentFilePath: data.parentFilePath,
            threshold: data.threshold,
            brightness: data.brightness,
            contrast: data.contrast,
            gamma: data.gamma,
            invert: data.invert,
            left: data.left,
            top: data.top,
            width: data.width,
            height: data.height,
            origWidth: data.origWidth,
            origHeight: data.origHeight,
            parentView: this.getView()
        })

    }

})

